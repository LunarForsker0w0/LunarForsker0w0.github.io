<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>–î–æ –Ω–∞—à–µ–π –≤—Å—Ç—Ä–µ—á–∏ üí´</title>

<!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –≤—ã—Å–æ—Ç–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö -->
<script>
  function setAppHeight() {
    const appHeight = window.innerHeight;
    document.documentElement.style.setProperty('--app-height', `${appHeight}px`);
  }
  setAppHeight();
  window.addEventListener('resize', setAppHeight);
  window.addEventListener('orientationchange', () => setTimeout(setAppHeight, 100));
</script>

<style>
* { box-sizing: border-box; margin: 0; padding: 0; }

/* –ü–æ–ª–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–∫—Ä–æ–ª–ª–∞ + —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ */
html, body {
  overflow: hidden !important;
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  width: 100%;
  height: var(--app-height, 100vh);
  font-family: 'Segoe UI', sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  background: linear-gradient(135deg, #9d81ba, #4b0066);
  color: white;
  user-select: none;
  touch-action: none; /* –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–∞–Ω-–∂–µ—Å—Ç—ã –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö */
}

h1 { font-size:1.8em; margin-bottom:10px; position:relative; z-index:1; }
.countdown { font-size:2.2em; font-weight:bold; letter-spacing:1px; position:relative; z-index:1; }
.label { font-size:0.9em; opacity:0.7; position:relative; z-index:1; margin-bottom:15px; }

.bg-element { position:absolute; border-radius:15px; pointer-events:none; }
.square { background: rgba(255,255,255,0.1); animation: floatSquare linear infinite alternate; }
@keyframes floatSquare { from{transform:translateY(0) translateX(0); opacity:0.05;} to{transform:translateY(-20px) translateX(20px); opacity:0.15;} }

/* CSS—Å–Ω–∞—è –∞–Ω–∏–º–∫–∞ */
/*.heart-bg { font-size:30px; color: rgba(255,100,150,0.3); animation: floatHeart linear infinite alternate; } */
/*@keyframes floatHeart { from{transform:translateY(0) translateX(0) rotate(0deg); opacity:0.3;} to{transform:translateY(-30px) translateX(20px) rotate(20deg); opacity:0.6;} }*/

.heart-bg {
  position: absolute;
  font-size: 30px;
  color: rgba(255,100,150,0.3);
  pointer-events: none;
  transform: translate(-50%, -50%);
  z-index: 0;
}

.particle { width:3px; height:3px; background:rgba(255,255,255,0.5); border-radius:50%; position:absolute; pointer-events:none; animation: floatParticle linear infinite; }
@keyframes floatParticle { from{transform:translateY(0); opacity:0.3;} to{transform:translateY(-50px); opacity:0;} }

.heart-click { position:absolute; font-size:20px; color:rgba(255,50,150,0.8); pointer-events:none; }
.sun, .moon { position:absolute; width:60px; height:60px; border-radius:50%; z-index:0; transition: opacity 2s linear; }
.sun { background: radial-gradient(circle, #FFD700, #FFA500); box-shadow:0 0 50px 20px rgba(255,223,0,0.4);}
.moon { background: radial-gradient(circle, #EEEEFF, #AAAAFF); box-shadow:0 0 40px 15px rgba(200,200,255,0.3); }

.main-heart { font-size:50px; animation:pulse 1.5s infinite; margin-bottom:10px; position:relative; z-index:1; }
@keyframes pulse { 0%{transform:scale(1);} 50%{transform:scale(1.2);} 100%{transform:scale(1);} }

@keyframes heartSwap {
  0% {
    transform: scale(1);
    opacity: 1;
  }
  50% {
    transform: scale(0.7);
    opacity: 0;
  }
  51% {
    opacity: 0;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}
.main-heart.swapping {
  animation: heartSwap 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

#toggleSlider {
  position: fixed;
  top: 10px;
  right: 10px;
  z-index: 1000;
  width: 35px;
  height: 35px;
  background: rgba(255,255,255,0.2);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}
#toggleSlider:hover { background: rgba(255,255,255,0.35); }
#toggleSlider span { font-size:18px; color:white; }

#sliderContainer {
  position: fixed;
  bottom: 10px;
  left: 5%;
  width: 90%;
  z-index: 1000;
  text-align: center;
  visibility: hidden;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease, visibility 0.3s ease;
}
#sliderContainer.visible {
  visibility: visible;
  opacity: 1;
  pointer-events: auto;
}
#timeSlider { width: 100%; }
#timeLabel { color: white; margin-top: 5px; font-size: 0.9em; }

.heart-piece { position: absolute; font-size: 35px; cursor: pointer; transition: transform 0.2s; }

@keyframes appearHeart {
  0% {
    transform: scale(0.2);
    opacity: 0;
  }
  70% {
    transform: scale(1.3);
    opacity: 1;
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

.heart-piece.appear {
  animation: appearHeart 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}


/* ‚úâÔ∏è –ö–æ–Ω–≤–µ—Ä—Ç—ã */
.envelope {
  position: absolute;
  font-size: 32px;
  opacity: 0;
  transform: scale(0.5);
  animation: appear 0.8s forwards;
  cursor: pointer;
  z-index: 10;
}
@keyframes appear {
  to { opacity: 1; transform: scale(1); }
}

.message {
  position: absolute;
  font-size: 1em;
  background: rgba(255,255,255,0.15);
  padding: 8px 14px;
  border-radius: 12px;
  backdrop-filter: blur(4px);
  opacity: 0;
  transform: translateY(-10px);
  animation: fadeOut 3.5s forwards;
}
@keyframes fadeOut {
  10% { opacity: 1; transform: translateY(-20px); }
  90% { opacity: 1; }
  100% { opacity: 0; transform: translateY(-40px); }
}
</style>
</head>
<body>

<h1>–î–æ –Ω–∞—à–µ–π –≤—Å—Ç—Ä–µ—á–∏ –æ—Å—Ç–∞–ª–æ—Å—å:</h1>
<div class="main-heart">‚ù§Ô∏è</div>
<div class="countdown" id="timer">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
<div class="label">10 –æ–∫—Ç—è–±—Ä—è 2026</div>

<div class="sun"></div>
<div class="moon"></div>

<div id="toggleSlider"><span>üåô</span></div>
<div id="sliderContainer">
  <input type="range" min="0" max="23.99" step="0.01" id="timeSlider">
  <div id="timeLabel">–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è: --:--</div>
</div>

<script>
// -------------------- –¢–∞–π–º–µ—Ä --------------------
function updateCountdown(){
  const target = new Date('2026-10-10T00:00:00');
  const now = new Date();
  const diff = target - now;
  if(diff <= 0){ 
    document.getElementById('timer').innerText = "–°–µ–≥–æ–¥–Ω—è üíñ"; 
    return; 
  }
  const d = Math.floor(diff / (1000 * 60 * 60 * 24));
  const h = Math.floor((diff / (1000 * 60 * 60)) % 24);
  const m = Math.floor((diff / (1000 * 60)) % 60);
  const s = Math.floor((diff / 1000) % 60);
  document.getElementById('timer').innerText = `${d}–¥ ${h}—á ${m}–º ${s}—Å`;
}
setInterval(updateCountdown, 1000);
updateCountdown();

// -------------------- –§–æ–Ω–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã --------------------
function createSquares(n){
  for(let i = 0; i < n; i++){
    const sq = document.createElement('div');
    sq.classList.add('bg-element','square');
    const size = 20 + Math.random() * 60;
    sq.style.width = sq.style.height = size + 'px';
    sq.style.top = Math.random() * (window.innerHeight - size) + 'px';
    sq.style.left = Math.random() * (window.innerWidth - size) + 'px';
    sq.style.animationDuration = (8 + Math.random() * 5) + 's';
    sq.style.opacity = 0.05 + Math.random() * 0.15;
    document.body.appendChild(sq);
  }
}
let floatingHearts = [];
const HEART_COUNT = 12;
const WIND_INTERVAL = 5000; // –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥ ‚Äî –Ω–æ–≤—ã–π –∏–º–ø—É–ª—å—Å
const REPULSION_RADIUS = 150;
const REPULSION_STRENGTH = 5000;

function createHearts(n) {
  for (let i = 0; i < n; i++) {
    const h = document.createElement('div');
    h.classList.add('heart-bg');
    h.innerText = '‚ù§Ô∏è';
    // –†–∞–∑–º–µ—Ä –∫–∞–∫ –≤ index.txt: –æ—Ç ~30px –¥–æ ~60px
    const size = 30 + Math.random() * 30;
    h.style.fontSize = size + 'px';
    h.style.opacity = 0.3 + Math.random() * 0.3;
    document.body.appendChild(h);
    floatingHearts.push({
      el: h,
      x: Math.random() * window.innerWidth,
      y: Math.random() * window.innerHeight,
      // –û—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ–µ, –ø–æ—á—Ç–∏ –Ω–µ–∑–∞–º–µ—Ç–Ω–æ–µ –Ω–∞—á–∞–ª—å–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ
      vx: (Math.random() - 0.5) * 2,  // –ë—ã–ª–æ *10 ‚Üí —Ç–µ–ø–µ—Ä—å *2
      vy: (Math.random() - 0.5) * 2,
      size: size
    });
  }
  requestAnimationFrame(animateHearts);
}

function animateHearts() {
  for (const heart of floatingHearts) {
    // –û—á–µ–Ω—å —Å–ª–∞–±–æ–µ –∑–∞—Ç—É—Ö–∞–Ω–∏–µ ‚Äî –ø–æ—á—Ç–∏ –Ω–µ–∑–∞–º–µ—Ç–Ω–æ–µ, –Ω–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç "—Ä–∞–∑–≥–æ–Ω"
    heart.vx *= 0.995;  // –ë—ã–ª–æ 0.92 ‚Üí —Ç–µ–ø–µ—Ä—å 0.995
    heart.vy *= 0.995;

    // –ü–ª–∞–≤–Ω–æ–µ "–¥—Ä–µ–π—Ñ–æ–≤–æ–µ" –¥–≤–∏–∂–µ–Ω–∏–µ (–∏–º–∏—Ç–∞—Ü–∏—è CSS alternate)
    // –î–æ–±–∞–≤–∏–º tiny random drift –∫–∞–∂–¥—ã–µ –∫–∞–¥—Ä—ã ‚Äî –Ω–æ –æ—á–µ–Ω—å —Å–ª–∞–±–æ
    if (Math.random() < 0.02) { // —Ä–∞–∑ –≤ ~50 –∫–∞–¥—Ä–æ–≤
      heart.vx += (Math.random() - 0.5) * 0.5;
      heart.vy += (Math.random() - 0.5) * 0.5;
    }

    // –û–≥—Ä–∞–Ω–∏—á–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å, —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ —Ä—ã–≤–∫–æ–≤
    const maxSpeed = 3;
    const speed = Math.hypot(heart.vx, heart.vy);
    if (speed > maxSpeed) {
      heart.vx = (heart.vx / speed) * maxSpeed;
      heart.vy = (heart.vy / speed) * maxSpeed;
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏
    heart.x += heart.vx;
    heart.y += heart.vy;

    // –ú—è–≥–∫–∏–π –æ—Ç—Å–∫–æ–∫ –æ—Ç –∫—Ä–∞—ë–≤
    if (heart.x < 0) { heart.x = 0; heart.vx = Math.abs(heart.vx) * 0.4; }
    if (heart.x > window.innerWidth) { heart.x = window.innerWidth; heart.vx = -Math.abs(heart.vx) * 0.4; }
    if (heart.y < 0) { heart.y = 0; heart.vy = Math.abs(heart.vy) * 0.4; }
    if (heart.y > window.innerHeight) { heart.y = window.innerHeight; heart.vy = -Math.abs(heart.vy) * 0.4; }

    // –ü—Ä–∏–º–µ–Ω–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é
    heart.el.style.left = heart.x + 'px';
    heart.el.style.top = heart.y + 'px';
  }
  requestAnimationFrame(animateHearts);
}
function createParticles(n){
  for(let i = 0; i < n; i++){
    const p = document.createElement('div');
    p.classList.add('particle');
    p.style.top = Math.random() * (window.innerHeight - 3) + 'px';
    p.style.left = Math.random() * (window.innerWidth - 3) + 'px';
    p.style.animationDuration = (5 + Math.random() * 5) + 's';
    document.body.appendChild(p);
  }
}
createSquares(10);
createHearts(12);
createParticles(50);

// -------------------- –†–∞–∑–ª–µ—Ç–∞—é—â–∏–µ—Å—è —Å–µ—Ä–¥–µ—á–∫–∏ --------------------
function createClickHearts(x, y){
  for(let i = 0; i < 15; i++){
    const h = document.createElement('div');
    h.classList.add('heart-click');
    h.innerText = '‚ù§Ô∏è';
    const size = 15 + Math.random() * 25;
    h.style.fontSize = size + 'px';
    h.style.left = x + 'px';
    h.style.top = y + 'px';
    document.body.appendChild(h);
    const dx = (Math.random() - 0.5) * 200;
    const dy = (Math.random() - 0.5) * 200;
    const dur = 1000 + Math.random() * 1000;
    h.animate([
      { transform: 'translate(0,0)', opacity: 1 },
      { transform: `translate(${dx}px, ${dy}px)`, opacity: 0 }
    ], { duration: dur, easing: 'ease-out', fill: 'forwards' });
    setTimeout(() => h.remove(), dur);
  }
}

// -------------------- –û—Ç—Ç–∞–ª–∫–∏–≤–∞–Ω–∏–µ —Ñ–æ–Ω–æ–≤—ã—Ö —Å–µ—Ä–¥–µ—Ü --------------------

function repulseHearts(x, y) {
  for (const heart of floatingHearts) {
    const dx = heart.x - x;
    const dy = heart.y - y;
    const dist = Math.hypot(dx, dy);
    if (dist < REPULSION_RADIUS && dist > 0) {
      const force = REPULSION_STRENGTH / (dist + 10); // +10 —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –¥–µ–ª–µ–Ω–∏—è –Ω–∞ 0
      heart.vx += (dx / dist) * force * 0.016; // 0.016 ‚âà dt –¥–ª—è 60 FPS
      heart.vy += (dy / dist) * force * 0.016;
    }
  }
}



// -------------------- –ï–î–ò–ù–´–ô –û–ë–†–ê–ë–û–¢–ß–ò–ö –° –ò–°–ö–õ–Æ–ß–ï–ù–ò–ï–ú –î–õ–Ø –¶–ï–ù–¢–†–ê–õ–¨–ù–û–ì–û –°–ï–†–î–¶–ê --------------------

function handleInteraction(x, y) {
  createClickHearts(x, y);   // —Ä–∞–∑–ª—ë—Ç
  repulseHearts(x, y);       // –æ—Ç—Ç–∞–ª–∫–∏–≤–∞–Ω–∏–µ —Ñ–æ–Ω–æ–≤—ã—Ö —Å–µ—Ä–¥–µ—Ü
}

document.body.addEventListener('click', e => {
  if (e.target.classList.contains('main-heart')) {
    changeMainHeart();
  } else {
    handleInteraction(e.clientX, e.clientY);
  }
});

document.body.addEventListener('touchstart', e => {
  if (e.touches.length === 1 && e.touches[0].target.classList.contains('main-heart')) {
    changeMainHeart();
    e.preventDefault();
  } else {
    for (let touch of e.touches) {
      handleInteraction(touch.clientX, touch.clientY);
    }
  }
}, { passive: false });



// -------------------- –°–æ–ª–Ω—Ü–µ –∏ –õ—É–Ω–∞ --------------------
const sun = document.querySelector('.sun');
const moon = document.querySelector('.moon');
const slider = document.getElementById('timeSlider');
const timeLabel = document.getElementById('timeLabel');
const toggleBtn = document.getElementById('toggleSlider');
const sliderContainer = document.getElementById('sliderContainer');
let manualTime = null;

toggleBtn.addEventListener('click', () => {
  sliderContainer.classList.toggle('visible');
});

slider.addEventListener('input', () => {
  manualTime = parseFloat(slider.value);
  updateSunMoon();
});

function updateSunMoon(){
  const now = new Date();
  const hours = manualTime !== null ? manualTime : now.getHours() + now.getMinutes() / 60;

  timeLabel.innerText = `–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è: ${Math.floor(hours)}:${Math.floor((hours % 1) * 60).toString().padStart(2, '0')}`;

  sun.style.opacity = (hours >= 6 && hours <= 18) ? 1 : 0;
  moon.style.opacity = (hours < 6 || hours > 18) ? 1 : 0;

  const sunY = (hours >= 6 && hours <= 18)
    ? 50 - 50 * Math.cos(((hours - 6) / 12) * Math.PI)
    : 150;
  const moonY = (hours < 6)
    ? 50 - 50 * Math.cos(((hours + 6) / 12) * Math.PI)
    : (hours > 18)
      ? 50 - 50 * Math.cos(((hours - 18) / 12) * Math.PI)
      : 150;
  sun.style.top = sunY + '%';
  moon.style.top = moonY + '%';

  const dayColor = hexToRgb('#9d81ba');
  const sunsetColor = hexToRgb('#ba8181');
  const nightColor = hexToRgb('#22182c');
  const nightEnd = hexToRgb('#3b1f4d');
  let bgColor;
  if (hours >= 6 && hours < 15) {
    const t = (hours - 6) / 9;
    bgColor = blendColors(dayColor, sunsetColor, t);
  } else if (hours >= 15 && hours < 18) {
    const t = (hours - 15) / 3;
    bgColor = blendColors(sunsetColor, nightColor, t);
  } else if (hours >= 18) {
    const t = (hours - 18) / 12;
    bgColor = blendColors(nightColor, nightEnd, t);
  } else {
    const t = hours / 6;
    bgColor = blendColors(nightEnd, dayColor, t);
  }
  document.body.style.background = `linear-gradient(135deg, rgb(${bgColor.join(',')}), #4b0066)`;
}

setInterval(updateSunMoon, 1000);
updateSunMoon();

function hexToRgb(hex) {
  return hex.match(/\w\w/g).map(c => parseInt(c, 16));
}
function lerp(a, b, t) {
  return a + (b - a) * t;
}
function blendColors(c1, c2, t) {
  return c1.map((v, i) => Math.round(lerp(v, c2[i], t)));
}

// -------------------- –ú–∏–Ω–∏-–∏–≥—Ä–∞ "–°–æ–±–µ—Ä–∏ —Ä–∞–∑–Ω–æ—Ü–≤–µ—Ç–Ω—ã–µ —Å–µ—Ä–¥—Ü–∞" --------------------
const heartContainer = document.createElement('div');
document.body.appendChild(heartContainer);
let pieces = [];
const pieceCount = 4;
const heartEmojis = ['‚ù§Ô∏è','üß°','üíõ','üíö','üíô','üíú','ü§é','üñ§','ü§ç','üíñ','üíó','üíì','üíï','üíû','üíü'];
const starColors = ['#FFD700','#FFFF66','#FF66FF','#66FFFF','#FF99FF'];

function spawnHeartPuzzle(){
  pieces.forEach(p => p.el.remove());
  pieces = [];
  for(let i = 0; i < pieceCount; i++){
    const p = document.createElement('div');
    p.classList.add('heart-piece','appear');
    p.innerText = heartEmojis[Math.floor(Math.random() * heartEmojis.length)];
    const x = 50 + Math.random() * (window.innerWidth - 100);
    const y = 50 + Math.random() * (window.innerHeight - 100);
    p.style.left = x + 'px';
    p.style.top = y + 'px';
    heartContainer.appendChild(p);
    pieces.push({ el: p, connected: [i], x: x, y: y });
    makeDraggable(p, i);
  }
    // –£–¥–∞–ª—è–µ–º –∫–ª–∞—Å—Å –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏, —á—Ç–æ–±—ã –Ω–µ –º–µ—à–∞—Ç—å drag-—Å—Ç–∏–ª—è–º
setTimeout(() => {
  document.querySelectorAll('.heart-piece').forEach(el => el.classList.remove('appear'));
}, 700); // —á—É—Ç—å –¥–æ–ª—å—à–µ –∞–Ω–∏–º–∞—Ü–∏–∏
}

function makeDraggable(el, index){
  let startX = 0, startY = 0, originalX = 0, originalY = 0, dragging = false;
  const pieceData = pieces[index];

  function startDrag(e){
    e.preventDefault();
    dragging = true;
    const t = e.touches ? e.touches[0] : e;
    startX = t.clientX; startY = t.clientY;
    originalX = pieceData.x; originalY = pieceData.y;
    el.style.zIndex = 1000;
    el.style.transform = 'scale(1.1)';
  }

  function drag(e){
    if (!dragging) return;
    e.preventDefault();
    const t = e.touches ? e.touches[0] : e;
    const dx = t.clientX - startX;
    const dy = t.clientY - startY;
    el.style.transform = `translate(${dx}px, ${dy}px) scale(1.1)`;
    pieceData.x = originalX + dx;
    pieceData.y = originalY + dy;
  }

  function stopDrag(){
    if (!dragging) return;
    dragging = false;
    el.style.zIndex = '';
    el.style.left = pieceData.x + 'px';
    el.style.top = pieceData.y + 'px';
    el.style.transform = '';
    checkConnection(index);
  }

  el.addEventListener('mousedown', startDrag);
  el.addEventListener('touchstart', startDrag, { passive: false });
  document.addEventListener('mousemove', drag);
  document.addEventListener('touchmove', drag, { passive: false });
  document.addEventListener('mouseup', stopDrag);
  document.addEventListener('touchend', stopDrag);
}

function checkConnection(idx){
  const threshold = 40;
  const current = pieces[idx];
  pieces.forEach((p, i) => {
    if (i === idx || current.connected.includes(i)) return;
    const dx = p.x - current.x;
    const dy = p.y - current.y;
    if (Math.hypot(dx, dy) < threshold) {
      const midX = current.x + dx / 2;
      const midY = current.y + dy / 2;
      current.x = midX; current.y = midY;
      p.x = midX; p.y = midY;
      current.el.style.left = midX + 'px';
      current.el.style.top = midY + 'px';
      p.el.style.left = midX + 'px';
      p.el.style.top = midY + 'px';
      const combinedSet = Array.from(new Set([...current.connected, ...p.connected]));
      pieces.forEach(piece => {
        if (combinedSet.includes(pieces.indexOf(piece))) {
          piece.connected = combinedSet;
        }
      });
    }
  });
  if (current.connected.length === pieceCount) {
    const centerX = current.x, centerY = current.y;
    pieces.forEach(p => p.el.remove());
    for (let i = 0; i < 30; i++) {
      const star = document.createElement('div');
      star.classList.add('heart-click');
      star.innerText = '‚≠ê';
      star.style.fontSize = (10 + Math.random() * 20) + 'px';
      star.style.color = starColors[Math.floor(Math.random() * starColors.length)];
      star.style.left = centerX + 'px';
      star.style.top = centerY + 'px';
      document.body.appendChild(star);
      const dx = (Math.random() - 0.5) * 200;
      const dy = (Math.random() - 0.5) * 200;
      const dur = 1000 + Math.random() * 1000;
      star.animate([
        { transform: 'translate(0,0)', opacity: 1 },
        { transform: `translate(${dx}px, ${dy}px)`, opacity: 0 }
      ], { duration: dur, easing: 'ease-out', fill: 'forwards' });
      setTimeout(() => star.remove(), dur);
    }
    setTimeout(spawnHeartPuzzle, 1000);
  }
}
spawnHeartPuzzle();

// -------------------- –°–ú–ï–ù–ê –¶–ï–ù–¢–†–ê–õ–¨–ù–û–ì–û –°–ï–†–î–¶–ê –° –ê–ù–ò–ú–ê–¶–ò–ï–ô --------------------
const mainHeart = document.querySelector('.main-heart');

function changeMainHeart() {
  if (mainHeart.classList.contains('swapping')) return; // –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∫–ª–∏–∫–∞

  mainHeart.classList.add('swapping');

  setTimeout(() => {
    const randomHeart = heartEmojis[Math.floor(Math.random() * heartEmojis.length)];
    mainHeart.innerText = randomHeart;
  }, 300); // –º–æ–º–µ–Ω—Ç –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è

  setTimeout(() => {
    mainHeart.classList.remove('swapping');
  }, 600); // –∫–æ–Ω–µ—Ü –∞–Ω–∏–º–∞—Ü–∏–∏
}

/* ------------------ ‚úâÔ∏è –°–æ–æ–±—â–µ–Ω–∏—è ------------------ */
const phrases = [
¬† "–Ø –¥—É–º–∞—é –æ —Ç–µ–±–µ üí≠",
¬† "–¢—ã - –º–æ—ë –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ üåô",
¬† "–°–∫–æ—Ä–æ –º—ã –±—É–¥–µ–º —Ä—è–¥–æ–º üíû",
¬† "–•–æ—á—É –æ–±–Ω—è—Ç—å —Ç–µ–±—è –∫—Ä–µ–ø–∫–æ –∫—Ä–µ–ø–∫–æ ü§ç",
¬† "–ú–∏—Ä —Å—Ç–∞–ª —è—Ä—á–µ —Å —Ç–æ–±–æ–π ‚ú®",
¬† "–õ—é–±–ª—é —Ç–µ–±—è üíú",
¬† "–¢—ã –º–æ—ë —á—É–¥–æ üå∏",
¬† "–ñ–¥—É —Å –Ω–µ—Ç–µ—Ä–ø–µ–Ω–∏–µ–º üí´",
¬† "–ù–µ –∑–∞–±—ã–≤–∞–π. –¢–´ –ú–û–©–û–©–©–©–©üëæ",
¬† "–ú–´ –ú–û–©–û–©–©–©–©–©–©üëæ",
¬† "–Ø –æ–±–Ω–∏–º—É —Ç–µ–±—è –∫—Ä–µ–ø–∫–æ –∫—Ä–µ–ø–∫–æ –¥–æ —Å–º–µ—Ä—Ç–∏–∏–∏üíù",
¬† "–õ—é–ª—é —Ç–µ–±—è—è—èüíì",
¬† "–õ—éüíï",
¬† "–¢–∏ –º–æ–π –º–∏–ª—ã–π –ë—ç–±–µ–ª–ª—åü•∞",
¬† "–ú–æ–µ —Å–µ—Ä–¥–µ—à–∫–æ —Å—Ö–æ–¥–∏—Ç —Å —É–º–∞ –æ—Ç —Ç–µ–±—è —Ö—ã—Öüî•",
¬† "–í—Å–µ –±—É–¥–µ—Ç —Ö–æ—Ä–æ—à–æ, –Ω–µ –Ω–∞–∫—Ä—É—á–∏–≤–∞–π —Å–µ–±—è. –õ–∞–¥–Ω–æ?üëÄ",
¬† "–¢—ã –∫–∞–∫ —Å–∞—Ö–∞—Ä–æ–∫ –≤ –∫–æ—Ñ–µ ‚òïüç´",
¬† "–ù–µ –∑–∞–±—ã–≤–∞–π –∫—É—Ñ–∞—Ç—å, —Ö–æ–ª–æ—Å–æ?üç´",
¬† "–ú–µ—á—Ç–∞—é... –≤–∑—è—Ç—å —Ç–µ–±—è –∑–∞ —Ä—É–∫—É..",
¬† "–¢—ã –∞–∫—Ç–∏–≤–∏—Ä—É–µ—à—å –º–æ–π –≤–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ç–µ–≥–º–µ–Ω—Ç—É–º —Å–∏–ª—å–Ω–µ–µ, —á–µ–º –∫–æ—Ñ–µ–∏–Ω –∏ –¥–æ—Ñ–∞–º–∏–Ω –≤–º–µ—Å—Ç–µüíì",
¬† "–¢—ã –ø–æ–≤—ã—à–∞–µ—à—å –º–æ–π —É—Ä–æ–≤–µ–Ω—å —ç–Ω–¥–æ—Ä—Ñ–∏–Ω–æ–≤ üå∏",
¬† "–° —Ç–æ–±–æ–π PQRST –º–æ–µ–π –∂–∏–∑–Ω–∏ –∏–¥–µ–∞–ª–µ–Ω —ã—Ö—ã—Ö—ãüíï",
];

// –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫
const timePhrases = {
¬† morning: ["–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ! ‚òÄÔ∏è –ü—É—Å—Ç—å –¥–µ–Ω—å –±—É–¥–µ—Ç —Å–ª–∞–¥–∫–∏–º!", "–°–æ–ª–Ω—ã—à–∫–æ, –ø—Ä–æ—Å—ã–ø–∞–π—Å—è üíõ"],
¬† day: ["–î–µ–Ω—å –ø—Ä–µ–∫—Ä–∞—Å–µ–Ω —Å —Ç–æ–±–æ–π üåº", "–ü—É—Å—Ç—å —Ç–≤–æ–π –¥–µ–Ω—å –±—É–¥–µ—Ç –ª—ë–≥–∫–∏–º üí´"],
¬† evening: ["–í–µ—á–µ—Ä–∫–æ–º –≤–º–µ—Å—Ç–µ —É—é—Ç–Ω–µ–µ üíñ", "–ù–æ—á—å –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç—Å—è, –Ω–æ —è –¥—É–º–∞—é –æ —Ç–µ–±–µ üåô"],
¬† night: ["–°–ø–æ–∫–æ–π–Ω–æ–π –Ω–æ—á–∏. –ü–∏—Ç–µ –∫—Ä–µ–ø–∫–æ –∫—Ä–µ–ø–∫–æ üåå", "–°–ª–∞–¥–∫–∏—Ö —Å–Ω–æ–≤, –º–æ–π –ª—é–±–∏–º—ã–π –ë—ç–±–µ–ª–ª—å üò¥", "–ü–∏—Ç–µ –∫—Ä–µ–ø–∫–æ –∫—Ä–µ–ø–∫–æ–æ–æ–æ–æ–æüíñ", "–ê —á–µ–≥–æ –º—ã –Ω–µ –¥—Ä—ã—Ö–Ω–∏–∏–∏–º? –ê–∞–∞? –Ω–µ–±–æ—Å—å —É—á–∏—Ç–µ —à–æ —Ç–æ, –Ω—É –ª–∞–¥–Ω–∞–∞–∞. –õ—é —Ç–µ–±—èüíï –ü–æ—è–∑—è–∑ –Ω–µ –ø–æ–º—Ä–∏"]
};

// ------------------ –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ñ–ª–∞–≥ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –∫–ª–∏–∫–∞ ------------------
let isFirstMessageShown = false;

// ------------------ –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ ------------------
function getTimeOfDay() {
¬† const hours = new Date().getHours();
¬† if (hours >= 6 && hours < 12) return "morning";
¬† if (hours >= 12 && hours < 18) return "day";
¬† if (hours >= 18 && hours < 22) return "evening";
¬† return "night";
}

function getRandomBetween(min, max) {
¬† return Math.random() * (max - min) + min;
}

function getRandomPhrase() {
¬† // –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö (–Ω–µ –ø–µ—Ä–≤—ã—Ö) –∫–ª–∏–∫–æ–≤
¬† const allPhrases = [...phrases, ...timePhrases[getTimeOfDay()]];
¬† return allPhrases[Math.floor(Math.random() * allPhrases.length)];
}

// ------------------ –°–ø–∞–≤–Ω –∫–æ–Ω–≤–µ—Ä—Ç–∞ ------------------
function spawnEnvelope() {
¬† const e = document.createElement('div');
¬† e.classList.add('envelope');
¬† e.innerText = 'üíå';
¬† e.style.position = 'absolute';

¬† const safeMarginX = 150; // –∑–∞–ø–∞—Å —Å–ª–µ–≤–∞ –∏ —Å–ø—Ä–∞–≤–∞
¬† const safeMarginY = 100; // –∑–∞–ø–∞—Å —Å–≤–µ—Ä—Ö—É –∏ —Å–Ω–∏–∑—É
¬† const maxX = window.innerWidth - safeMarginX;
¬† const maxY = window.innerHeight - safeMarginY;

¬† e.style.left = getRandomBetween(safeMarginX, maxX) + 'px';
¬† e.style.top = getRandomBetween(safeMarginY, maxY) + 'px';

¬† e.style.transition = 'opacity 0.8s ease, transform 0.8s ease';
¬† e.style.opacity = 0;
¬† document.body.appendChild(e);

¬† // –ü–ª–∞–≤–Ω–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ
¬† requestAnimationFrame(() => e.style.opacity = 1);

¬† let removed = false;

¬† function showMessage() {
¬† ¬† if (removed) return;
¬† ¬† removed = true;
¬† ¬† 
¬† ¬† let phrase;

¬† ¬† // --- –õ–û–ì–ò–ö–ê –î–õ–Ø –ü–ï–†–í–û–ì–û –ö–õ–ò–ö–ê ---
¬† ¬† if (!isFirstMessageShown) {
¬† ¬† ¬† // –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∫–ª–∏–∫–µ –≤—ã–±–∏—Ä–∞–µ–º –¢–û–õ–¨–ö–û –∏–∑ timePhrases
¬† ¬† ¬† const timeOfDay = getTimeOfDay();
¬† ¬† ¬† const timeSpecificPhrases = timePhrases[timeOfDay];
¬† ¬† ¬† phrase = timeSpecificPhrases[Math.floor(Math.random() * timeSpecificPhrases.length)];
¬† ¬† ¬† 
¬† ¬† ¬† // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥, —á—Ç–æ–±—ã —Å–ª–µ–¥—É—é—â–∏–µ –∫–ª–∏–∫–∏ —Ä–∞–±–æ—Ç–∞–ª–∏ –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –ª–æ–≥–∏–∫–µ
¬† ¬† ¬† isFirstMessageShown = true; 
¬† ¬† ¬† 
¬† ¬† } else {
¬† ¬† ¬† // –ü—Ä–∏ –≤—Å–µ—Ö –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∫–ª–∏–∫–∞—Ö –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É
¬† ¬† ¬† phrase = getRandomPhrase();
¬† ¬† }
¬† ¬† // --------------------------------

¬† ¬† const msg = document.createElement('div');
¬† ¬† msg.classList.add('message');
¬† ¬† msg.innerText = phrase; // –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Ñ—Ä–∞–∑—É
¬† ¬† msg.style.position = 'absolute';

¬† ¬† // –ø—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ–±—ã —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –≤—ã—Ö–æ–¥–∏–ª–æ –∑–∞ —ç–∫—Ä–∞–Ω
¬† ¬† const msgWidth = 200; // –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
¬† ¬† const msgHeight = 60; // –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
¬† ¬† let left = parseFloat(e.style.left);
¬† ¬† let top = parseFloat(e.style.top);

¬† ¬† if (left + msgWidth > window.innerWidth) left = window.innerWidth - msgWidth - 20;
¬† ¬† if (top + msgHeight > window.innerHeight) top = window.innerHeight - msgHeight - 20;

¬† ¬† msg.style.left = left + 'px';
¬† ¬† msg.style.top = top + 'px';
¬† ¬† msg.style.opacity = 0;
¬† ¬† msg.style.transition = 'opacity 1s ease, transform 1s ease';
¬† ¬† document.body.appendChild(msg);

¬† ¬† requestAnimationFrame(() => {
¬† ¬† ¬† msg.style.opacity = 1;
¬† ¬† ¬† msg.style.transform = 'translateY(-20px)';
¬† ¬† });

¬† ¬† setTimeout(() => {
¬† ¬† ¬† msg.style.opacity = 0;
¬† ¬† ¬† msg.style.transform = 'translateY(-40px)';
¬† ¬† ¬† setTimeout(() => msg.remove(), 1000);
¬† ¬† }, 2500);

¬† ¬† e.remove();
¬† }

¬† e.addEventListener('click', showMessage);

¬† setTimeout(() => {
¬† ¬† if (!removed) {
¬† ¬† ¬† removed = true;
¬† ¬† ¬† e.style.opacity = 0;
¬† ¬† ¬† e.style.transform = 'scale(0.5) rotate(-20deg)';¬†
¬† ¬† ¬† setTimeout(() => e.remove(), 800);¬†
¬† ¬† }
¬† }, 6000);
}


// ------------------ –†–∞–Ω–¥–æ–º–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª —Å–ø–∞–≤–Ω–∞ ------------------
function spawnLoop() {
¬† spawnEnvelope();
¬† const interval = getRandomBetween(4000, 60000); 
¬† setTimeout(spawnLoop, interval);
}

// –ó–∞–ø—É—Å–∫
spawnLoop();
</script>
</body>
</html>











